* {
  box-sizing: border-box;
}
body {
  font-family: 'Inter', sans-serif;
  margin: 0;
  padding: 20px;
  background: #f5f7fa;
  color: #333;
}
.header {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  margin-bottom: 20px;
}
.header img {
  height: 60px;
}
.title {
  font-size: 28px;
  font-weight: 600;
  color: #c0392b;
}
.scoreboard {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  margin-bottom: 20px;
  gap: 16px;
}
.department {
  width: 120px;
  padding: 16px;
  border-radius: 12px;
  text-align: center;
  color: white;
  font-weight: bold;
}
.department .score {
  font-size: 24px;
  margin-top: 10px;
}
.scenario-box,
.question-box,
.intro-box {
  background: white;
  padding: 18px;
  margin: 16px auto;
  border-radius: 12px;
  max-width: 800px;
  box-shadow: 0 0 12px rgba(0, 0, 0, 0.05);
  text-align: center;
  position: relative; /* allow overlays */
}
.question-box { min-height: 52vh; }
.intro-box h2 {
  margin-bottom: 10px;
}
.choices {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-top: 16px;
}
.choice-btn {
  padding: 12px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-size: 16px;
  background: #ffffff;
  border: 1px solid #e0e6ed;
  transition: border-color 0.2s, background 0.2s;
  text-align: left;
  /* Hide length differences: clamp to 2 lines with ellipsis */
  display: -webkit-box;
  line-clamp: 2;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  white-space: normal;
}
.choice-btn:hover {
  background: #f7f9fb;
  border-color: #c8d0da;
}
.choice-btn.selected {
  background: #eef6ff;
  border-color: #9ec5fe;
}
.choice-btn.correct {
  background-color: #2ecc71;
  color: white;
}
.choice-btn.incorrect {
  background-color: #e74c3c;
  color: white;
}

/* Points badge shown when an answer is selected */
.point-badge {
  float: right;
  margin-left: 8px;
  padding: 2px 8px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 700;
  border: 1px solid #e0e6ed;
  background: #f7f9fb;
  color: #334155;
}
.point-badge.good { border-color: #b7e4c7; background: #e9f9ef; color: #1e874b; }
.point-badge.ok   { border-color: #bfd3ff; background: #eef6ff; color: #0f5bb5; }
.point-badge.bad  { border-color: #f5c2c7; background: #fff0f0; color: #c0392b; }

/* Enhanced explanation box */
.explain-box { text-align: left; padding: 10px; }
.explain-top { display: flex; align-items: center; gap: 8px; margin-bottom: 6px; }
.explain-dept { font-weight: 700; color: #555; }
.explain-text { margin: 6px 0; }
.explain-tagline { font-size: 13px; color: #666; }
.controls {
  display: flex;
  justify-content: center;
  gap: 16px;
  margin-top: 28px;
}
.controls button {
  padding: 12px 24px;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  background: #27ae60;
  color: white;
  cursor: pointer;
}
.controls button:hover {
  background: #1e874b;
}
.next-button {
  display: flex;
  justify-content: center;
  margin-top: 14px;
}
.q-progress {
  font-weight: 600;
  color: #555;
  margin-bottom: 6px;
}
.hidden {
  display: none;
}

/* Loading indicator used in the question box while fetching */
.loader {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 12px;
  padding: 24px 0;
  color: #666;
}
.loader .spinner {
  width: 32px;
  height: 32px;
  border: 3px solid #e0e6ed;
  border-top-color: #27ae60;
  border-radius: 50%;
  animation: spin 0.9s linear infinite;
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* ===== Flashy Round Complete Overlay ===== */
.winner-overlay {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 26px;
  border-radius: 12px;
  background: radial-gradient(circle at 30% 20%, rgba(46,204,113,0.25), rgba(0,0,0,0.72) 55%),
              rgba(0,0,0,0.72);
  backdrop-filter: blur(8px);
  overflow: hidden;
  z-index: 3;
}

/* subtle animated light sweep */
.winner-overlay::before {
  content: "";
  position: absolute;
  inset: -40%;
  background: linear-gradient(120deg, transparent 35%, rgba(255,255,255,0.12) 50%, transparent 65%);
  transform: rotate(10deg);
  animation: sweep 4.5s linear infinite;
}

@keyframes sweep {
  0% { transform: translateX(-20%) rotate(10deg); opacity: 0.0; }
  10% { opacity: 1; }
  50% { opacity: 0.6; }
  100% { transform: translateX(20%) rotate(10deg); opacity: 0.0; }
}

.winner-card {
  position: relative;
  z-index: 2; /* ensure above confetti canvas */
  width: 100%;
  max-width: 820px;
  border-radius: 20px;
  background: #0b1220;
  color: #eef2ff;
  box-shadow: 0 40px 120px rgba(0,0,0,0.55);
  overflow: hidden;
  transform: translateY(8px);
  animation: popIn 420ms ease-out forwards;
  border: 1px solid rgba(255,255,255,0.08);
}

@keyframes popIn {
  from { transform: translateY(12px) scale(0.98); opacity: 0; }
  to { transform: translateY(0px) scale(1); opacity: 1; }
}

.winner-hero {
  padding: 26px 22px;
  background: radial-gradient(circle at 20% 20%, rgba(46,204,113,0.35), transparent 55%),
              linear-gradient(135deg, #1e874b 0%, #2ecc71 45%, #16a085 100%);
  text-align: center;
  position: relative;
}

.winner-hero h1 {
  margin: 0;
  font-size: 44px;
  letter-spacing: 0.4px;
  text-shadow: 0 10px 30px rgba(0,0,0,0.25);
}

.winner-hero p {
  margin: 10px 0 0;
  opacity: 0.95;
  font-size: 16px;
}

.trophy {
  font-size: 52px;
  line-height: 1;
  margin-bottom: 8px;
  display: inline-block;
  filter: drop-shadow(0 18px 30px rgba(0,0,0,0.25));
  animation: trophyPulse 1.6s ease-in-out infinite;
}

@keyframes trophyPulse {
  0%, 100% { transform: translateY(0) scale(1); }
  50% { transform: translateY(-2px) scale(1.04); }
}

.winner-body {
  padding: 18px 18px 22px;
  background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
}

.winner-pill {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  border-radius: 999px;
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.10);
  color: #fff;
  font-weight: 700;
  margin: 8px 0 18px;
}

.winner-pill .badge {
  width: 30px;
  height: 30px;
  border-radius: 999px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: #ffd43b;
  color: #1b1f2a;
  font-size: 14px;
  font-weight: 900;
  box-shadow: 0 10px 30px rgba(255,212,59,0.35);
}

/* Podium */
.podium {
  display: grid;
  grid-template-columns: 1fr 1.15fr 1fr;
  gap: 12px;
  margin: 10px 0 18px;
}

.podium-card {
  border-radius: 16px;
  padding: 14px 12px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.10);
  text-align: center;
}

.podium-card .place {
  font-weight: 900;
  letter-spacing: 0.3px;
  opacity: 0.95;
  margin-bottom: 6px;
}

.podium-card .dept {
  font-weight: 800;
  color: #fff;
}

.podium-card .pts {
  margin-top: 6px;
  font-weight: 900;
  color: #2ecc71;
}

.podium-card.first {
  background: rgba(255,212,59,0.18);
  border-color: rgba(255,212,59,0.35);
  transform: translateY(-6px);
}

.podium-card.first .pts { color: #ffd43b; }
.podium-card.second .pts { color: #a5b4fc; }
.podium-card.third .pts { color: #f4a261; }

/* Score list */
.results-title {
  text-align: left;
  font-weight: 800;
  margin: 12px 6px 10px;
  color: rgba(255,255,255,0.92);
}

.results-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 10px;
}

.result-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 12px 12px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.05);
}

.result-left {
  display: flex;
  align-items: center;
  gap: 10px;
  text-align: left;
}

.rank {
  width: 36px;
  height: 36px;
  border-radius: 12px;
  background: rgba(255,255,255,0.12);
  color: #fff;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-weight: 900;
}

.dept-name {
  font-weight: 800;
  color: #fff;
}

.dept-sub {
  font-size: 12px;
  color: rgba(255,255,255,0.65);
  margin-top: 2px;
}

.result-score {
  font-weight: 900;
  color: #2ecc71;
  font-size: 18px;
}

.result-row.top {
  border-color: rgba(255,212,59,0.30);
  background: rgba(255,212,59,0.12);
}

.result-row.top .rank {
  background: #ffd43b;
  color: #1b1f2a;
}

/* buttons */
.winner-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: center;
  margin-top: 18px;
}

.winner-actions button {
  padding: 12px 18px;
  border-radius: 12px;
  border: none;
  cursor: pointer;
  font-weight: 900;
  font-size: 15px;
  transition: transform 120ms ease, opacity 120ms ease;
}

.winner-actions button:hover { transform: translateY(-1px); }
.winner-actions button:active { transform: translateY(0px); opacity: 0.9; }

.winner-actions .primary {
  background: linear-gradient(135deg, #27ae60, #2ecc71);
  color: #082014;
  box-shadow: 0 16px 40px rgba(46,204,113,0.28);
}

.winner-actions .secondary {
  background: rgba(255,255,255,0.10);
  color: #fff;
  border: 1px solid rgba(255,255,255,0.12);
}

/* Confetti canvas sits above overlay */
.confetti-canvas {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 1; /* keep below winner card */
}



/* Under construction message box */
.uc-box {
  background: #fffceb;
  border: 1px solid #f5e6a7;
  color: #6b5d15;
  border-radius: 12px;
  padding: 20px;
  max-width: 800px;
  margin: 0 auto;
}
.uc-box h3 { margin: 0 0 8px 0; }
.uc-box p { margin: 0; }

/* ===================== */
/*  DARK MODE SUPPORT    */
/* ===================== */
@media (prefers-color-scheme: dark) {
  body {
    background: #181c22;
    color: #e3e6eb;
  }
  .header img {
    filter: brightness(0.85) contrast(1.1);
  }
  .title {
    color: #ffb347;
  }
  .scoreboard {
    background: none;
  }
  .department {
    background: #232a36;
    color: #ffe082;
  }
  .scenario-box,
  .question-box,
  .intro-box {
    background: #232a36;
    color: #e3e6eb;
    box-shadow: 0 0 16px rgba(0,0,0,0.45);
  }
  .choice-btn {
    background: #232a36;
    color: #e3e6eb;
    border: 1px solid #374151;
  }
  .choice-btn:hover {
    background: #2a3140;
    border-color: #4b5563;
  }
  .choice-btn.selected {
    background: #1e293b;
    border-color: #60a5fa;
  }
  .choice-btn.correct {
    background-color: #27ae60;
    color: #fff;
  }
  .choice-btn.incorrect {
    background-color: #c0392b;
    color: #fff;
  }
  .point-badge {
    background: #232a36;
    color: #ffe082;
    border: 1px solid #374151;
  }
  .point-badge.good { border-color: #27ae60; background: #1e293b; color: #27ae60; }
  .point-badge.ok   { border-color: #60a5fa; background: #1e293b; color: #60a5fa; }
  .point-badge.bad  { border-color: #c0392b; background: #1e293b; color: #ffb4a2; }
  .explain-box {
    background: #232a36;
    color: #e3e6eb;
  }
  .controls button {
    background: #27ae60;
    color: #fff;
  }
  .controls button:hover {
    background: #219150;
  }
  .winner-card {
    background: #181c22;
    color: #ffe082;
    border: 1px solid #232a36;
  }
  .winner-hero {
    background: linear-gradient(135deg, #232a36 0%, #181c22 100%);
  }
  .winner-pill {
    background: #232a36;
    color: #ffe082;
    border: 1px solid #374151;
  }
  .winner-pill .badge {
    background: #ffe082;
    color: #232a36;
  }
  .podium-card {
    background: #232a36;
    color: #ffe082;
    border: 1px solid #374151;
  }
  .podium-card.first {
    background: #ffb34733;
    border-color: #ffb347;
  }
  .podium-card.first .pts { color: #ffb347; }
  .podium-card.second .pts { color: #60a5fa; }
  .podium-card.third .pts { color: #ffb4a2; }
  .results-title {
    color: #ffe082;
  }
  .result-row {
    background: #232a36;
    border: 1px solid #374151;
  }
  .result-row.top {
    background: #ffb34733;
    border-color: #ffb347;
  }
  .rank {
    background: #232a36;
    color: #ffe082;
  }
  .result-row.top .rank {
    background: #ffb347;
    color: #232a36;
  }
  .dept-name {
    color: #ffe082;
  }
  .dept-sub {
    color: #ffe08299;
  }
  .result-score {
    color: #27ae60;
  }
  .winner-actions .primary {
    background: linear-gradient(135deg, #27ae60, #219150);
    color: #ffe082;
  }
  .winner-actions .secondary {
    background: #232a36;
    color: #ffe082;
    border: 1px solid #374151;
  }
  .uc-box {
    background: #232a36;
    border: 1px solid #ffe082;
    color: #ffe082;
  }
}
