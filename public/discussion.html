<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Tabletop Scenario Generator</title>
        <link rel="stylesheet" href="/css/style.css">
        <script src="js/discussion-scenarios.js"></script>
        <script>
        // Keep minimal: theme.js will handle toggle and OS scheme
        </script>
        <style>
            body {
                font-family: 'Segoe UI', Arial, sans-serif;
                margin: 0;
                min-height: 100vh;
                color: #06203a; /* darker base text for contrast */
                font-size: 16px;
            }
            .container {
                max-width: 1100px;
                margin: 0 auto;
                padding: 32px 16px 48px 16px;
            }
            .controls {
                background: transparent;
                border-radius: 0;
                box-shadow: none;
                padding: 0;
                margin-bottom: 0;
                margin-top: 18px;
                border: none;
            }
            .header {
                text-align: center;
                margin-bottom: 24px;
            }
            .header h1 {
                font-size: 2.3rem;
                margin-bottom: 0.5rem;
            }
            .header p {
                color: #b0b8c1;
                font-size: 1.1rem;
            }
            .status-indicator {
                background: #f5f7fa;
                color: #28a745;
                padding: 8px 18px;
                border-radius: 6px;
                margin-bottom: 18px;
                font-family: monospace;
                font-size: 1rem;
                border-left: 4px solid #28a745;
                box-shadow: none;
                transition: background 0.2s, color 0.2s;
            }
            .status-indicator.error {
                border-left-color: #dc3545;
                background: #ffeaea;
                color: #dc3545;
            }
            .steps-bar {
                text-align: center;
                margin-bottom: 24px;
                font-size: 1.3rem;
                font-weight: 600;
                color: #fff;
            }
            .steps-bar .step-label {
                color: #fff;
            }
            .steps-bar {
                        margin-bottom: 32px;
                        font-size: 1.35rem;
                        font-weight: 700;
                        letter-spacing: 0.01em;
                font-size: 1.15rem;
                font-weight: 600;
            }
            .steps-bar .step-number {
                color: #2196f3;
                font-size: 1.15rem;
                font-weight: 700;
                margin-right: 4px;
            }
            /* hidden: we show sub-departments via tooltip/title to avoid overflow */
            .department-sub { display: none !important; }
            .dept-list {
                list-style: none;
                padding: 10px 14px;
                margin: 10px auto 18px auto;
                max-width: 920px;
                display: flex;
                flex-direction: column;
                gap: 6px;
                text-align: center;
                border-radius: 8px;
                background: rgba(255,255,255,0.02);
            }
            .dept-list li { color: #06203a; font-weight:700; font-size:1rem; }
            body.dark-mode .dept-list { background: rgba(255,255,255,0.02); }
            body.dark-mode .dept-list li { color: #e6eef8; }
            .department-grid {
                        gap: 28px;
                        margin: 0 auto 38px auto;
                        max-width: 900px;
                        background: linear-gradient(120deg, #e3eafc 0%, #fbe3e3 100%) !important;
                        border-radius: 14px;
                        padding: 18px 0 10px 0;
                        border: none !important;
            }
            .department-grid {
                display: grid;
                grid-template-columns: repeat(3, 1fr); /* 3 across */
                grid-template-rows: repeat(2, 1fr); /* force two rows */
                grid-auto-rows: minmax(120px, 1fr);
                gap: 20px 22px;
                margin: 0 auto 28px auto;
                max-width: 920px;
                justify-content: center;
                padding: 8px 8px;
                background: transparent; /* remove busy gradient */
            }
            .department-card {
                background: #ffffff;
                box-shadow: 0 6px 18px rgba(10,25,47,0.06);
                border-radius: 12px;
                color: #0b2540;
                padding: 22px 16px;
                transition: border 0.18s, background 0.18s, box-shadow 0.18s, transform 0.12s;
                font-size: 1rem;
                will-change: transform, box-shadow;
                text-align: center;
                cursor: pointer;
                border: 1px solid #e6eef6;
                min-height: 120px;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                gap: 8px;
            }
            /* Ensure card text is high contrast and readable */
            .department-card, .department-card .department-name { color: #06203a; }
                /* Hover/selected behavior consolidated below to match complexity option */
            .department-icon {
                font-size: 3.8rem; /* larger, clearer */
                margin-bottom: 6px;
                display: block;
                line-height: 1;
            }
            .department-card.selected, .department-card:hover {
                border: 1.5px solid #2b88ff;
                background: #f0f7ff;
                box-shadow: 0 8px 24px rgba(11,37,78,0.08);
                transform: translateY(-4px);
                color: #06203a;
            }
            /* duplicate removed; .department-icon defined above */
            .complexity-options {
                display: flex;
                flex-direction: row;
                justify-content: center;
                align-items: center;
                gap: 18px;
                margin-bottom: 12px;
                max-width: 900px;
                margin-left: auto;
                margin-right: auto;
            }
            .complexity-option {
                background: rgba(255,255,255,0.92);
                box-shadow: 0 2px 12px rgba(0,0,0,0.08);
                border-radius: 16px;
                padding: 20px 18px;
                font-size: 1.05rem;
                font-weight: 700;
                transition: border 0.18s, background 0.18s, box-shadow 0.18s, transform 0.12s;
                margin-top: 0;
                letter-spacing: 0.01em;
                will-change: transform, box-shadow;
                cursor: pointer;
                border: 2px solid transparent;
                min-width: 160px;
                text-align: center;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                color: #222;
            }
            .complexity-option.selected, .complexity-option:hover {
                border: 2px solid #2196f3;
                background: #e3eafc;
                box-shadow: 0 4px 18px rgba(33,150,243,0.10);
                transform: scale(1.03);
                color: #0b2540;
            }
            /* Ensure selected department cards match complexity selected visuals */
            .department-card.selected, .department-card:hover {
                border: 2px solid #2196f3;
                background: #e3eafc;
                box-shadow: 0 4px 18px rgba(33,150,243,0.10);
                transform: scale(1.03);
                color: #0b2540;
            }
            .department-card .department-name {
                font-weight: 900;
                color: inherit;
                font-size: 1.18rem; /* about 19px */
                line-height: 1.2;
                margin: 0 6px;
            }

            /* Scenario and discussion text readability */
            .scenario-content {
                color: #042533; /* very dark for contrast */
                font-size: 1.05rem;
                line-height: 1.6;
            }
            .discussion-points h4 { color: #032a44; font-weight:800; font-size:1.15rem }
            .discussion-points li { color: #032a44; font-size: 1.05rem; line-height: 1.6; }

            /* Make generate button and complexity options higher contrast */
            .generate-btn { color: #06203a; font-weight: 800; }
            .complexity-option { color: #06203a; }
            /* Department badge removed; visual selection uses .department-card.selected */
            .complexity-label {
                font-weight: 700;
                font-size: 1.05rem;
                color: #222;
            }
            .complexity-desc {
                color: #6c757d;
                font-size: 0.88rem;
                margin-top: 6px;
            }
            @media (max-width: 768px) {
                .complexity-options {
                    flex-direction: column;
                    gap: 12px;
                }
                .complexity-option {
                    min-width: 0;
                    width: 100%;
                }
            }
            .generate-btn {
                background: linear-gradient(135deg, #28d17c, #1abc9c);
                        box-shadow: none;
            }
            /* complexity styles above supersede older dark-theme rules */
            .generate-section {
                display: flex;
                justify-content: center;
                margin: 0 auto 0 auto;
                background: #fff;
                border-radius: 12px;
                box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            }
            .generate-btn {
                background: linear-gradient(135deg, #e3eafc, #fbe3e3);
                color: #222;
                border: none;
                padding: 16px 48px;
                border-radius: 12px;
                font-size: 1.25rem;
                font-weight: 700;
                cursor: pointer;
                transition: background 0.2s, box-shadow 0.2s, transform 0.1s;
                box-shadow: 0 2px 16px rgba(40,209,124,0.10);
                margin-top: 10px;
            }
            .generate-btn:disabled {
                background: #444c56;
                color: #b0b8c1;
                cursor: not-allowed;
            }
            .scenario-output {
                margin-top: 40px;
                display: none;
            }
            .scenario-header {
                display: flex;
                align-items: center;
                gap: 18px;
                margin-bottom: 18px;
            }
            .scenario-icon {
                font-size: 2.2rem;
            }
            .scenario-title h3 {
                margin: 0 0 4px 0;
                font-size: 1.4rem;
            }
            .scenario-title p {
                margin: 0;
                color: #b0b8c1;
                font-size: 1rem;
            }
            .refresh-btn {
                background: linear-gradient(135deg, #17a2b8, #138496);
                color: white;
                border: none;
                padding: 10px 25px;
                border-radius: 25px;
                font-size: 1rem;
                font-weight: 500;
                cursor: pointer;
                transition: all 0.3s ease;
                margin-left: 15px;
            }
            .refresh-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(23, 162, 184, 0.4);
            }
            .discussion-points {
                background: #e6f9f0;
                border-radius: 12px;
                padding: 20px;
                border-left: 5px solid #28d17c;
                color: #222;
                margin-top: 24px;
            }
            .discussion-points h4 {
                color: #1abc9c;
                margin: 0 0 15px 0;
                font-size: 1.3rem;
            }
            .discussion-points ul {
                margin: 0;
                padding-left: 20px;
            }
            .discussion-points li {
                color: #17a2b8;
                margin-bottom: 10px;
                font-size: 1.05rem;
            }
            .back-btn {
                background: transparent;
                color: #b0b8c1;
                border: 2px solid #2c3e50;
                padding: 10px 20px;
                border-radius: 8px;
                text-decoration: none;
                display: inline-block;
                margin-bottom: 20px;
                transition: all 0.3s ease;
            }
            .back-btn:hover {
                background: #2c3e50;
                color: white;
            }
            @media (max-width: 1024px) {
                .department-grid {
                    grid-template-columns: repeat(3, 1fr);
                }
            }

            /* Strong overrides to counter global theme CSS using !important in style.css */
            /* Force a 3x2 layout and readable card styling (use !important to win cascade) */
            .ttsg #departmentGrid {
                display: grid !important;
                /* fixed column width close to card width to reduce extra gaps */
                grid-template-columns: repeat(3, 160px) !important;
                grid-auto-rows: auto !important;
                row-gap: 12px !important;
                column-gap: 14px !important;
                gap: 12px 14px !important;
                justify-content: center !important;
                margin: 6px auto 12px !important;
                width: 100% !important;
                max-width: 680px !important;
                padding: 6px !important;
            }

            .ttsg .department-card {
                width: 150px !important;
                height: 150px !important;
                min-width: 140px !important;
                min-height: 140px !important;
                padding: 14px 10px !important;
                border-radius: 12px !important;
                background: #ffffff !important;
                border: 1px solid #e6eef6 !important;
                box-shadow: 0 8px 20px rgba(10,25,47,0.06) !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                flex-direction: column !important;
                text-align: center !important;
                color: #06203a !important;
                font-size: 1rem !important;
            }

            .ttsg .department-card .department-icon {
                font-size: 3rem !important;
                margin-bottom: 6px !important;
            }

            .ttsg .department-name {
                font-size: 1.0rem !important;
                font-weight: 800 !important;
                color: #06203a !important;
                margin-top: 6px !important;
                line-height: 1.1 !important;
                white-space: normal !important;
                text-align: center !important;
                padding: 0 6px !important;
            }

            /* Dark-mode safe overrides */
            body.dark-mode .ttsg .department-card {
                background: #f8fafc !important;
                color: #06203a !important;
                border-color: #e6eef6 !important;
                box-shadow: 0 6px 18px rgba(10,25,47,0.06) !important;
            }

            body.dark-mode .ttsg .department-name { color: #06203a !important; }
            @media (max-width: 768px) {
                .container {
                    padding: 12px 2vw 32px 2vw;
                }
                .selectors-row {
                    flex-direction: column;
                    gap: 18px;
                }
                /* On small screens stack as two columns for readability */
                .department-grid {
                    grid-template-columns: repeat(2, 1fr);
                }
                .complexity-options {
                    grid-template-columns: 1fr;
                }
                .scenario-header {
                    flex-direction: column;
                    text-align: center;
                }
                .generate-section {
                    margin-left: 0;
                    margin-top: 18px;
                    justify-content: flex-start;
                }
            }

            /* Grid styles removed to allow explicit two-row flex layout */
        </style>
    </head>
    <body class="ttsg">
    <a href="/" class="back-menu-btn">‚Üê Back to Main Menu</a>
    <div class="container">
        
        <div class="header">
            <img src="/images/bank-logo.png" alt="SSBTX Bank Logo">
            <h1>Tabletop Scenario Generator</h1>
            <p style="color:#b0b8c1; font-size:1.13rem; font-weight:500; margin-top:10px;">
                Select a department below and click <span style="color:#28d17c; font-weight:700;">Generate Scenario</span> to view a training scenario.
            </p>
            <!-- Department cards will show their mapped sub-departments under each label -->
            <!-- Departments are listed directly under the title -->
            <div id="departmentGrid" style="margin-top:18px;">
                <!-- Departments populated by JavaScript -->
            </div>
        </div>

        <div class="status-indicator" id="statusIndicator" style="display:none;">
            <strong>Status:</strong> <span id="statusText">Ready to generate scenarios</span>
        </div>

        <div class="complexity-options" style="margin-bottom: 18px; max-width: 600px; margin-left: auto; margin-right: auto;">
            <div class="complexity-option selected" data-complexity="intermediate">
                <div class="complexity-label">Intermediate</div>
                <div class="complexity-desc">Standard scenario, moderate challenge</div>
            </div>
            <div class="complexity-option" data-complexity="advanced">
                <div class="complexity-label">Advanced</div>
                <div class="complexity-desc">Complex scenario, high challenge</div>
            </div>
            <div class="complexity-option" data-complexity="specialized">
                <div class="complexity-label">Specialized</div>
                <div class="complexity-desc">Niche or expert-level scenario</div>
            </div>
        </div>

        <div class="generate-section" style="margin-bottom: 32px;">
            <button class="generate-btn" id="generateBtn" disabled style="padding:10px 22px; font-size:1rem; border-radius:8px;">
                <span class="loading-spinner"></span>
                <span id="generateBtnText">Generate Scenario</span>
            </button>
        </div>

        <div class="scenario-output" id="scenarioOutput" style="display:none;">
            <div class="scenario-header" style="background:#fff; border-radius:12px; box-shadow:0 2px 12px rgba(0,0,0,0.08); padding:24px; color:#222;">
                <div class="scenario-icon" id="scenarioIcon">üè¢</div>
                <div class="scenario-title">
                    <h3 id="scenarioTitle">Scenario Title</h3>
                    <p id="scenarioDepartment">Department Name</p>
                </div>
                <button class="refresh-btn" onclick="generateScenario()">üîÑ Generate New</button>
            </div>

            <div class="scenario-content" id="scenarioContent" style="background:#fff; border-radius:12px; box-shadow:0 2px 12px rgba(0,0,0,0.08); color:#222; margin-top:18px; padding:18px;">
                <!-- AI-generated scenario will appear here -->
            </div>

            <div class="discussion-points" id="discussionSection" style="background:#fff; border-radius:12px; box-shadow:0 2px 12px rgba(0,0,0,0.08); color:#222; margin-top:18px; padding:18px;">
                <h4>üí≠ Discussion Points</h4>
                <ul id="discussionPoints">
                    <!-- AI-generated discussion points will appear here -->
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Replace just the <script> section in your existing discussion.html file with this:

let selectedDepartment = null;
let selectedComplexity = 'intermediate';

// New grouped departments (6 groups)
const departments = [
    { id: 'Mortgage-Servicing-Compliance', name: 'Loan Operations & Compliance', icon: 'üè†' },
    { id: 'HR-Accounting-BackOffice', name: 'Business Administration', icon: 'üßæ' },
    { id: 'Frontline-Operations', name: 'Frontline Operations', icon: 'üè¶' },
    { id: 'Executive-Leadership-Loans', name: 'Executive Leadership & Loans', icon: 'üëî' },
    { id: 'IT', name: 'IT', icon: 'üíª' },
    { id: 'Call-Center', name: 'Call Center', icon: 'üìû' }
];

// Mapping from new group ids to existing scenario keys present in discussion-scenarios.js
const departmentKeyMap = {
    // Group mappings set per user request:
    // Loan Operations & Compliance => Loan Servicing, Compliance, Mortgage (mapped to Loans)
    'Mortgage-Servicing-Compliance': ['Loan Servicing', 'Compliance', 'Loans'],
    // Business Administration => HR, Accounting, Bookkeeping
    'HR-Accounting-BackOffice': ['HR', 'Accounting', 'Bookkeeping'],
    // Frontline Operations => Tellers, New Accounts
    'Frontline-Operations': ['Tellers', 'New Accounts'],
    // Executive Leadership => CEO/SVPs and Loans
    'Executive-Leadership-Loans': ['CEO/SVPs', 'Loans'],
    'IT': ['IT', 'Security', 'IT/Security'],
    'Call-Center': ['Call Center', 'Deposits']
};

function updateStatus(message, isError = false) {
    // Hide status indicator for static/offline mode except for debugging
    const statusIndicator = document.getElementById('statusIndicator');
    const statusText = document.getElementById('statusText');
    if (isError) {
        statusText.textContent = message;
        statusIndicator.className = 'status-indicator error';
        statusIndicator.style.display = '';
    } else {
        // Hide status for normal operation
        statusIndicator.style.display = 'none';
    }
    // Console log for debugging
    console.log(`[STATUS] ${message}`, isError ? '(ERROR)' : '');
}

function createDepartmentCards() {
    const grid = document.getElementById('departmentGrid');
    grid.innerHTML = '';

    departments.forEach((dept, index) => {
        const card = document.createElement('div');
        card.className = 'department-card';

        // emoji-only icon (no image assets required)
        const iconCircle = document.createElement('div');
        iconCircle.className = 'department-icon-circle';
        const iconWrap = document.createElement('div');
        iconWrap.className = 'department-icon';
        iconWrap.textContent = dept.icon;
        // sizing handled by CSS

        const name = document.createElement('div');
        name.className = 'department-name';
        name.textContent = dept.name;
        // set mapped sub-departments as a tooltip (title) instead of visible text
        const mapped = departmentKeyMap[dept.id] || [];
        const mappedText = mapped.map(m => m.replace(/\//g, ' / ')).join(', ');
        if (mappedText) card.setAttribute('title', mappedText);
        // spacing handled by CSS

        iconCircle.appendChild(iconWrap);
        card.appendChild(iconCircle);
        card.appendChild(name);

        card.addEventListener('click', () => selectDepartment(dept.id, card));

        grid.appendChild(card);
    });
    // Grid enforces 5 columns; 10 cards render as 5 top + 5 bottom
    
    updateStatus(`${departments.length} departments loaded`);
}

function selectDepartment(deptId, cardElement) {
    // Remove selection from all cards
    document.querySelectorAll('.department-card').forEach(card => {
        card.classList.remove('selected');
    });
    
    // Add selection to clicked card
    cardElement.classList.add('selected');
    selectedDepartment = deptId;
    
    // Enable generate button if department is selected
    updateGenerateButton();
    updateStatus(`Selected department: ${departments.find(d => d.id === deptId).name}`);
}

function setupComplexitySelector() {
    const options = document.querySelectorAll('.complexity-option');
    
    options.forEach(option => {
        option.addEventListener('click', () => {
            // Remove selection from all options
            options.forEach(opt => opt.classList.remove('selected'));
            
            // Add selection to clicked option
            option.classList.add('selected');
            selectedComplexity = option.dataset.complexity;
            
            updateStatus(`Complexity set to: ${selectedComplexity}`);
        });
    });
}

function updateGenerateButton() {
    const generateBtn = document.getElementById('generateBtn');
    generateBtn.disabled = !selectedDepartment;
}

function generateScenario() {
    if (!selectedDepartment) {
        updateStatus('Please select a department first', true);
        return;
    }

    const generateBtn = document.getElementById('generateBtn');
    const generateBtnText = document.getElementById('generateBtnText');

    // Show loading state
    generateBtn.classList.add('loading');
    generateBtn.disabled = true;
    generateBtnText.textContent = 'Generating scenario...';
    updateStatus('Generating scenario from templates...');

    // Use discussion-scenarios.js data
    try {
        // Find scenarios for the selected department. Support new grouped ids via departmentKeyMap.
        let scenarios = [];
        if (window.discussionScenarios) {
            const mappedKeys = departmentKeyMap[selectedDepartment] || [selectedDepartment];
            mappedKeys.forEach(key => {
                const list = window.discussionScenarios[key];
                if (Array.isArray(list)) scenarios = scenarios.concat(list);
            });
        }
        if (!scenarios || !Array.isArray(scenarios) || scenarios.length === 0) {
            throw new Error('No scenarios found for this department');
        }
        // Pick a random scenario
        const scenario = scenarios[Math.floor(Math.random() * scenarios.length)];
        displayScenario(scenario);
        updateStatus('Scenario generated successfully.');
    } catch (error) {
        console.error('[DEBUG] Error:', error);
        updateStatus(`Error: ${error.message}`, true);
        displayErrorFallback();
    } finally {
        // Reset button state
        generateBtn.classList.remove('loading');
        generateBtn.disabled = false;
        generateBtnText.textContent = 'Generate Scenario';
    }
}

function displayScenario(data) {
    console.log('[DEBUG] Displaying scenario:', data);
    
    const dept = departments.find(d => d.id === selectedDepartment);
    
    // Update header
    document.getElementById('scenarioIcon').textContent = dept.icon;
    document.getElementById('scenarioTitle').textContent = data.title || 'AI Generated Scenario';
    document.getElementById('scenarioDepartment').textContent = `${dept.name} Department - ${selectedComplexity.charAt(0).toUpperCase() + selectedComplexity.slice(1)} Level`;
    
    // Update content - handle multiple possible field names
    const scenarioText = data.description || data.scenario || 'Scenario description not available';
    document.getElementById('scenarioContent').textContent = scenarioText;
    
    // Update discussion points
    const discussionContainer = document.getElementById('discussionPoints');
    discussionContainer.innerHTML = '';
    
    // Handle multiple possible field names
    const discussionPoints = data.discussionPoints || data.questions || data.discussion || [];
    
    console.log('[DEBUG] Discussion points:', discussionPoints);
    
    if (Array.isArray(discussionPoints) && discussionPoints.length > 0) {
        discussionPoints.forEach(point => {
            const li = document.createElement('li');
            
            // Handle different point formats
            if (typeof point === 'string') {
                li.textContent = point;
            } else if (point && point.text) {
                li.textContent = point.text;
            } else if (point && point.question) {
                li.textContent = point.question;
            } else {
                li.textContent = 'Discussion point';
            }
            
            discussionContainer.appendChild(li);
        });
    } else {
        // Simple fallback
        const fallbackPoints = [
            'How would you handle this situation as a team?',
            'What are the key risks and how can they be mitigated?',
            'What processes or procedures should be followed?',
            'How should you communicate with stakeholders?',
            'What follow-up actions are necessary?'
        ];
        
        fallbackPoints.forEach(point => {
            const li = document.createElement('li');
            li.textContent = point;
            discussionContainer.appendChild(li);
        });
    }
    
    // Show scenario output
    document.getElementById('scenarioOutput').style.display = 'block';
    
    // Scroll to scenario
    document.getElementById('scenarioOutput').scrollIntoView({ 
        behavior: 'smooth',
        block: 'start' 
    });
}

function displayErrorFallback() {
    const dept = departments.find(d => d.id === selectedDepartment);
    document.getElementById('scenarioIcon').textContent = dept.icon;
    document.getElementById('scenarioTitle').textContent = 'No Scenarios Available';
    document.getElementById('scenarioDepartment').textContent = `${dept.name} Department`;
    document.getElementById('scenarioContent').textContent = 'No scenarios are available for this department in the offline template. Please select a different department or contact your administrator to add more scenarios.';
    const discussionContainer = document.getElementById('discussionPoints');
    discussionContainer.innerHTML = '<li>Try a different department</li><li>Contact your administrator to add more scenarios</li>';
    document.getElementById('scenarioOutput').style.display = 'block';
    document.getElementById('scenarioOutput').scrollIntoView({ behavior: 'smooth' });
}

// Initialize everything when page loads
document.addEventListener('DOMContentLoaded', function() {
    console.log('[DEBUG] Page loaded, initializing...');
    
    createDepartmentCards();
    setupComplexitySelector();
    
    // Add click handler to generate button
    document.getElementById('generateBtn').addEventListener('click', generateScenario);
    
    updateStatus('Ready to generate scenarios');
    console.log('[DEBUG] Initialization complete');
});
    </script>
    <script src="/js/theme.js"></script>
    </body>
</html>